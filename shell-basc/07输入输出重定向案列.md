
## 创建


#### 创建临时目录

```
#!/bin/bash

# using a temporary directory

#XXXXXX主要用来随机后缀名

tempdir=`mktemp -d dir.XXXXXX`
cd $tempdir

tempfile1=`mktemp temp.XXXXXX`
tempfile2=`mktemp temp.XXXXXX`

#exec命令用于调用并执行指令的命令。exec命令通常用在shell脚本程序中，可以调用其他的命令。
#如果在当前终端中使用命令，则当指定的命令执行完毕后会立即退出终端
#exec(选项)(参数)

exec 7> $tempfile1 
exec 8> $tempfile2

echo "Sending data to directory $tempdir"
# 向文件写入消息
echo "This is a test1 line of data for $tempfile1" >&7
echo "This is a test2 line of data for $tempfile2" >&8

```

#### 创建本地临时文件

```
#!/bin/bash

# creating and using a temp file

tempfile=`mktemp test.XXXXXX`

exec 3>$tempfile

echo "This script writes to temp file $tempfile"

echo "This is the first line" >&3
echo "This is the second line" >&3
echo "This is the last line" >&3
echo "我自己写入消息到文件里面" >&3

# 查看文件 cat
exec 3>&-

echo "Done creating temp file. The contents are:"

cat $tempfile

# 删除文件
rm -f $tempfile 2>/dev/null

```

#### 在tmp目录创建临时文件

```
#!/bin/bash

# creating a temp file in /tmp

tempfile=`mktemp -t tmp.XXXXXX`

echo "This is a test file" > $tempfile
echo "This is the second line of the test" >> $tempfile

echo ”The temp is locate at : $tempfile“
#查看
cat $tempfile
#删除
rm -f $tempfile
```


## 重定向

#### 临时重定向

```
#!/bin/bash
# testing STDERR messages

echo "This is an error " >&2
echo "This is another error"
echo "This is also an error" >&2

```

#### 在脚本中使用重定向输入

```
#!/bin/bash
# redirecting the inpiut

# 从test中读取数据，而不是从STDIN中读取数据
exec 0< test
count=1
while read line
do
	echo "Line #$count : $line "
	count=$[ $count +1 ]
done

```

#### 永久重定向

```
#!/bin/bash
# testing STDERR messages
# redirecting all to a file

# 脚本执行期间，用exec命令告诉shell重定向某个特定文件描述符
exec 2>test

ls badtest
echo "This is test of redirecting all output"
echo "from a script to another file"

exec 1>test1
echo "This is the end of the script"
echo "but this should go to the testerror file" >&2

```

#### 记录信息

```
#!/bin/bash

# using the tee command for logging
#将输入一边发送到STDOUT，一边发送到日志文件
tempfile=test
echo "This is the start of the test" | tee $tempfile
echo "This is the second line of the test" | tee -a $tempfile
echo "This is the end line of the test" | tee -a $tempfile

```

## 创建自己的重定向

#### 创建输入文件描述符

```
#!/bin/bash
# redirecting input file descriptors

exec 3>&1
echo "This is the 3 file descriptor" >&3

exec 6>&0
exec 0<test

count=1
while read line
do
	echo "Line #$count: $line"
	count=$[ $count+1 ]
done
exec 0<&6
read -p "Are you done now?" answer
case $answer in
Y|y) echo "Goodbye";;
N|n) echo "Sorry, this is the end";;
esac

```

#### 创建输出文件描述符

```
#!/bin/bash

# using an alternative file descriptor

exec 3>test

echo "This should display on the monitor"
echo "and this should be stored in the file" >&3
echo "Then this should be back on the monitor"


```

#### 创建读写文件描述符

```
#!/bin/bash
# testing inpiut/output file descriptor

exec 3<> test
read line <&3
echo "Read: $line"
echo "This is the test line" >&3

```

#### 关闭文件描述符

````
#!/bin/bash
# testing closing file descriptors

exec 3>test
echo "This is a test line of data" >&3

# closing file descriptor
exec 3>&-

echo "This won't work" >&3

cat test

#覆盖前一个test文件
exec 3>test
echo "This'll be bad" >&3
````

#### 从以重定向的文件描述符中恢复

```
#!/bin/bash

#storing STDOUT, then coming back to it

exec 3>&1
exec 1>test

echo "This should store in output file"
echo "along with this line"

exec 1>&3

echo "Now things should be back to normal"

```

